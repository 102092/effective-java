# 적시에 방어적 복사본을 만들라



## 질문



## 정리

- Date는 불변 아님. Instant는 불변, 후자를 사용하자
  - Date는 사용하지 말라
- 방어적 복사본을 만들고, 이 후에 이 복사본에 대한 유효성을 검사해야한다.
  - 왜?
  - 멀티스레딩 환경이라면, 원본객체에 대한 유효성 검사 후, 복사본을 만드는 그 찰나의 취약한 순간에 다른 스레드가 원본 객체를 수정할 위험이 있기 때문
- 방어적 복사본을 만들 때, `clone` 메서드를 사용하면 안된다.
  - 왜냐면 원하는 클래스가 아닌, 공격자가 만들어놓은 하위 클래스(악의를 가진)를 반환할 수 있기 때문에
  - 즉 확장 가능한 클래스를 clone하는 건 위험함

- 클라이언트에게 인스턴스의 통제권을 넘겨주면 위험하다